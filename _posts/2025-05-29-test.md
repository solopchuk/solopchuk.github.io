---
layout: post
title:  "Test"
---

$$
\log p(z,x) \propto -
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}^{T}

\begin{bmatrix}
\Sigma_{z} & \Sigma_{zx}\\
\Sigma_{xz} & \Sigma_{x}
\end{bmatrix}^{-1}

\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}.
$$

$$
\begin{bmatrix}
\Sigma_{z} & \Sigma_{zx}\\
\Sigma_{xz} & \Sigma_{x}
\end{bmatrix}^{-1}
=
\begin{bmatrix}
1 & 0\\
-\Sigma_{x}^{-1}\Sigma_{xz} & 1
\end{bmatrix}
\begin{bmatrix}
(\Sigma_{z} - \Sigma_{zx}\Sigma_{x}^{-1}\Sigma_{xz})^{-1} & 0\\
0 & \Sigma_{x}^{-1}
\end{bmatrix}
\begin{bmatrix}
1 & -\Sigma_{zx}\Sigma_{x}^{-1}\\
0 & 1
\end{bmatrix}
$$

If we denote \\( \Sigma_{z} - \Sigma_{zx}\Sigma_{x}^{-1}\Sigma_{xz} \\) by  \\( \textcolor{red}{S} \\), we could multiply the components as follows:

$$
\ln p(z,x) \propto
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}^{T}
\begin{bmatrix}
1 & 0\\
-\Sigma_{x}^{-1}\Sigma_{xz} & 1
\end{bmatrix}
\begin{bmatrix}
\textcolor{red}{S}^{-1} & 0\\
0 & \Sigma_{x}^{-1}
\end{bmatrix}
\begin{bmatrix}
1 & -\Sigma_{zx}\Sigma_{x}^{-1}\\
0 & 1
\end{bmatrix}
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}
$$

$$
\ln p(z,x) \propto
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}^{T}
\begin{bmatrix}
1 & 0\\
-\Sigma_{x}^{-1}\Sigma_{xz} & 1
\end{bmatrix}
\begin{bmatrix}
\textcolor{red}{S}^{-1} & 0\\
0 & \Sigma_{x}^{-1}
\end{bmatrix}
\begin{bmatrix}
z - \mu_{z} -\Sigma_{zx}\Sigma_{x}^{-1}(x - \mu_{x}) \\
x - \mu_{x}
\end{bmatrix}
$$

$$
\ln p(z,x) \propto
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}^{T}
\begin{bmatrix}
1 & 0\\
-\Sigma_{x}^{-1}\Sigma_{xz} & 1
\end{bmatrix}
\begin{bmatrix}
\textcolor{red}{S}^{-1}(z - \mu_{z} -\Sigma_{zx}\Sigma_{x}^{-1}(x - \mu_{x}))\\
\Sigma_{x}^{-1}(x - \mu_{x})
\end{bmatrix}
\begin{bmatrix}
z - \mu_{z}\\
x - \mu_{x}
\end{bmatrix}^{T}
$$

$$
\begin{bmatrix}
\textcolor{red}{S}^{-1}(z - \mu_{z} -\Sigma_{zx}\Sigma_{x}^{-1}(x - \mu_{x}))\\
-\Sigma_{x}^{-1}\Sigma_{xz}\textcolor{red}{S}^{-1}(z - \mu_{z} -\Sigma_{zx}\Sigma_{x}^{-1}(x - \mu_{x})) + \Sigma_{x}^{-1}(x - \mu_{x})
\end{bmatrix}
=
(\Delta z)^{T}\textcolor{red}{S}^{-1}(\Delta z -\Sigma_{zx}\Sigma_{x}^{-1}(\Delta x)) \\
& - (\Delta x)^{T}\Sigma_{x}^{-1}\Sigma_{xz}\textcolor{red}{S}^{-1}(\Delta z -\Sigma_{zx}\Sigma_{x}^{-1}(\Delta x)) + (\Delta x)^{T}\Sigma_{x}^{-1}(\Delta x)
=
\underbrace{(\Delta z - \Sigma_{zx}\Sigma_{x}^{-1}(\Delta x))^{T}\textcolor{red}{S}^{-1}(\Delta z -\Sigma_{zx}\Sigma_{x}^{-1}(\Delta x))}_\textrm{$\log p(z|x)$} + \underbrace{(\Delta x)^{T}\Sigma_{x}^{-1}(\Delta x)}_\textrm{$\log p(x)$}
$$

We can now equate the two resulting quadratic forms with the marginal and conditional distribution by inspection:
$$
p(x) = \mathcal{N}(x|\mu_{x},\  \Sigma_{x}).
$$
$$
p(z|x) = \mathcal{N}(z|\mu_{z} + \Sigma_{zx}\Sigma_{x}^{-1}(x - \mu_{x}), \Sigma_{z} - \Sigma_{zx}\Sigma_{x}^{-1}\Sigma_{xz}). 
$$

The mean of the conditional distribution $p(z|x)$ can be also written as:
$$
\begin{equation}
\mu_{z|x} = \mu_{z} -\Lambda_{z}^{-1}\Lambda_{zx}(x - \mu_{x}) =  \Sigma_{z|x}(\Lambda_{z}\mu_{z} - \Lambda_{zx}(x - \mu_{x}))
\end{equation}
$$

% $\textrm{Proof: } \overbrace{(A - BD^{-1}C)}^{\Lambda_{z}^{-1}}\overbrace{(A - BD^{-1}C)^{-1}BD^{-1}}^{-\Lambda_{zx}} = \overbrace{BD^{-1}}^{\Sigma_{zx}\Sigma_{x}^{-1}}, \textrm{and } \Sigma_{z|x} = \Lambda_{z}^{-1}.\\$

<img src="/assets/images/test.svg" alt="test figure">

Test document.

<img src="/assets/images/test2.svg" alt="test figure">

Test document.

<img src="/assets/images/test3.svg" alt="test figure">
